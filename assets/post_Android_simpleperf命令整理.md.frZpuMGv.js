import{_ as s,o as i,c as a,a6 as n}from"./chunks/framework.DnJfIKBR.js";const C=JSON.parse('{"title":"AOSP代码环境配置","description":"","frontmatter":{"title":"AOSP代码环境配置","layout":"doc","navbar":true,"sidebar":true,"aside":false},"headers":[],"relativePath":"post/Android/simpleperf命令整理.md","filePath":"post/Android/simpleperf命令整理.md","lastUpdated":1718396635000}'),h={name:"post/Android/simpleperf命令整理.md"},k=n(`<p>simpleperf record -e cs_etm --app com.asobimo.toramonline -a</p><p>simpleperf record --app com.asobimo.toramonline -g</p><p>simpleperf report -g --gui</p><p>python report_html.py -i record/perf.data -o record/report.html</p><p>report.py -i record/perf.data -g</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">用法:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simpleperf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [常用选项] 子命令 [子命令参数]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">常用选项:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    -h/--help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     打印此帮助信息。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    --log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">severit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 设置日志的最小严重性。可能的严重性包括</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> verbose、debug、warning、info、error、fatal。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                     默认是</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> info。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    --log-to-android-buffer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  将日志写入</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Android</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 日志缓冲区而不是标准错误。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    --version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     打印</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simpleperf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 的版本信息。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">子命令:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    api-collect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         收集由应用</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> API</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 生成的记录数据。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    api-prepare</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         通过应用</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> API</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 准备记录。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    debug-unwind</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        调试/测试离线展开。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                转储</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 记录文件。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    help</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                打印</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simpleperf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 的帮助信息。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    inject</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              解析</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ETM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 指令跟踪数据。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    kmem</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                收集内核内存分配信息。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    list</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                列出可用的事件类型。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    merge</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               合并多个</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf.data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 文件为一个。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    monitor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">             监视事件并将其文本表示打印到标准输出。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    record</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              在</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf.data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 中记录采样信息。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              报告</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf.data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 中的采样信息。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    report-sample</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       报告</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf.data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 中的原始采样信息。</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    stat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                收集性能计数器信息。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    trace-sched</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         跟踪系统范围内的进程运行时事件。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">用法:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simpleperf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> record</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [选项] [--] [命令 [命令参数]]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       收集运行中</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [命令] 的采样信息。可以使用 -a/-p/-t 选项来更改采样信息的目标。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       默认选项为:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cpu-cycles</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4000</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf.data。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">选择监控线程:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     系统范围内的收集。使用</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --exclude-perf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 排除</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simpleperf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 进程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package_name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    配置</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Android</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 应用程序进程。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                      在非</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 设备上，应用必须是可调试的，因为我们使用</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run-as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 切换到应用的上下文。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pid1,pid2,...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       记录现有进程的事件。与</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 互斥。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tid1,tid2,...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 记录现有线程的事件。与</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 互斥。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">选择监控事件类型:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> event1[:modifier1],event2[:modifier2],...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">             选择要记录的一系列事件。事件可以是:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) 在 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">simpleperf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 中列出的事件名称</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) 以 rN 格式的原始 PMU 事件。N 是十六进制数。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                  例如，r1b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 选择事件编号</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0x1b。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) 通过 --kprobe 选项添加的 kprobe 事件。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">             可以添加修饰符来定义如何监控事件。可能的修饰符是:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 仅监控用户空间事件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 仅监控内核空间事件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> event1[:modifier],event2[:modifier2],...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">             类似于</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 选项。但在同一</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 选项中指定的事件作为一组监控，并同时调度进出。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--trace-offcpu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   当线程从</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 上调度时生成样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                 类似于</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;-c 1 -e sched:sched_switch&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--kprobe</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kprobe_event1,kprobe_event2,...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">             在记录期间添加</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kprobe</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 事件。kprobe_event</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 的格式在内核的</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Documentation/trace/kprobetrace.rst</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 中。示例:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               &#39;p:myprobe do_sys_open $arg2:string&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 添加事件</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kprobes:myprobe</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               &#39;r:myretprobe do_sys_open $retval:s64&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 添加事件</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kprobes:myretprobe</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">选择监控选项:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> freq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      设置事件采样频率。表示每秒最多记录</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [freq] 个样本。对于非跟踪点事件，默认选项是 -f 4000。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     设置事件采样周期。表示每</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [count] 个事件发生时记录一个样本。对于跟踪点事件，默认选项是 -c 1。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--call-graph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dwarf[,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;dump_stack_size&gt;]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">             启用调用图记录。使用帧指针或</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dwarf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 调试帧作为解析堆栈中调用图的方法。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">             默认是</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dwarf,65528。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           与</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;--call-graph dwarf&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 相同。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--clockid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clock_id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      使用所选时钟生成样本的时间戳。可能的值是:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> realtime,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> monotonic,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> monotonic_raw,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> boottime,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf。如果支持，默认是</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> monotonic，否则是</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--cpu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cpu_item1,cpu_item2,...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">             仅在选定的</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 上收集样本。cpu_item</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 可以是</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 编号如</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1，或</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 范围如</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0-3。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--duration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time_in_sec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  监控</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time_in_sec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 秒而不是运行</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [命令]。这里 time_in_sec 可以是任何正浮点数。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-j</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> branch_filter1,branch_filter2,...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">             启用已采取的分支堆栈采样。每个样本捕获一系列连续的已采取分支。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">             定义的过滤器如下:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                any:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 任何类型的分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                any_call:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 任何函数调用或系统调用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                any_ret:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 任何函数返回或系统调用返回</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ind_call:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 任何间接分支</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                u:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 仅当分支目标在用户级别时</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                k:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 仅当分支目标在内核中时</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">             此选项至少需要一个分支类型</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> among</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> any,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> any_call,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> any_ret,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ind_call。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           启用已采取的分支堆栈采样。与</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;-j any&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 相同。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mmap_pages</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   设置用于接收来自内核的样本数据的缓冲区大小。它应为</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 的幂。如果未设置，将使用最大可能值</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1024。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--aux-buffer-size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">buffer_siz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  设置</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 缓冲区大小，仅用于</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs-etm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 事件类型。需要为</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 的幂并与页面大小对齐。使用的内存大小是</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (buffer_size </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (cpu_count </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)。默认是 4M。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--no-inherit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  不记录创建的子线程/进程。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--cpu-percent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">percen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  设置记录使用的</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CPU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 时间的最大百分比。百分比范围为</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [1-100]，默认是 25。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--addr-filter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> filter_str1,filter_str2,...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                提供</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cs-etm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 指令跟踪的地址过滤器。filter_str</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 接受以下格式:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                  &#39;filter  &lt;addr-range&gt;&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 在范围内跟踪指令</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                  &#39;start &lt;addr&gt;&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 当</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 是</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 时开始跟踪</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                  &#39;stop &lt;addr&gt;&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">           --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 当</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 是</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 时停止跟踪</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addr-range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">接受以下格式:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                  &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">file_path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;                            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 二进制文件中的代码段</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                  &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vaddr_start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;vaddr_end&gt;@&lt;file_path&gt;  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 二进制文件的一部分</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                  &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kernel_addr_start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;kernel_addr_end&gt;  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 内核空间的一部分</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">接受以下格式:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                  &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vaddr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;file_path&gt;      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 二进制文件中的虚拟地址</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                  &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kernel_addr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;            </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 内核地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                示例:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                  &#39;filter 0x456-0x480@/system/lib/libc.so&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                  &#39;start 0x456@/system/lib/libc.so,stop 0x480@/system/lib/libc.so&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--tp-filter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> filter_string</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    为前一个跟踪点事件设置</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> filter_string。格式在内核的</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Documentation/trace/events.rst</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 中。示例:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;prev_comm != &quot;simpleperf&quot; &amp;&amp; (prev_pid &gt; 1)&#39;。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Dwarf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 展开选项:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--post-unwind</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">yes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">no</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) 如果使用 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--call-graph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dwarf\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 选项，则用户的堆栈将记录在</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf.data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 中，并在记录时展开。使用</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --post-unwind=yes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 切换到记录后展开。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--no-unwind</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   如果使用</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--call-graph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dwarf\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 选项，则用户的堆栈将默认展开。使用此选项禁用用户堆栈的展开。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--no-callchain-joiner</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  如果使用</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--call-graph</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dwarf\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 选项，则默认使用调用链连接器来打破</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 64k</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 堆栈限制并构建更完整的调用图。然而，构建的调用图在所有情况下可能并不正确。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--callchain-joiner-min-matching-nodes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               当使用调用链连接器时，设置连接调用链所需的匹配节点。计数应</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1。默认是</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--no-cut-samples</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Simpleperf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 使用记录缓冲区缓存从内核接收的记录。当缓冲区中可用空间达到低水平时，它会剪切样本中的部分堆栈数据。当可用空间达到关键水平时，它会丢弃所有样本。此选项使</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simpleperf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 在可用空间达到低水平时不剪切样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--keep-failed-unwinding-result</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        保留展开失败的原因。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--keep-failed-unwinding-debug-info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    保留展开失败的调试信息。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">样本过滤选项:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--exclude-perf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                排除</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simpleperf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 进程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--exclude-pid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pid1,pid2,...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   排除选定进程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--exclude-tid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tid1,tid2,...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   排除选定线程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--exclude-process-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> process_name_regex</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   排除名称包含正则表达式的进程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--exclude-thread-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thread_name_regex</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     排除名称包含正则表达式的线程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--exclude-uid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uid1,uid2,...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   排除属于选定</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 的进程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--include-pid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pid1,pid2,...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   包含选定进程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--include-tid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tid1,tid2,...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   包含选定线程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--include-process-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> process_name_regex</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   包含名称包含正则表达式的进程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--include-thread-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thread_name_regex</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     包含名称包含正则表达式的线程的样本。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--include-uid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uid1,uid2,...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   包含属于选定</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 的进程的样本。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">记录文件选项:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--no-dump-kernel-symbols</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  不在</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf.data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 中转储内核符号。默认情况下，内核符号将在需要时转储。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--no-dump-symbols</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       不在</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf.data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 中转储符号。默认情况下，符号会转储到</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf.data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 中，以支持在其他环境中报告。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> record_file_name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    设置记录文件名，默认是</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> perf.data。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--size-limit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SIZE[K</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">M</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">G]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      记录达到</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SIZE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 字节的记录后停止。默认是无限制。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--symfs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">di</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    查找相对于此目录的符号文件。此选项用于提供带有符号表和调试信息的文件，这些文件用于展开和转储符号。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--add-meta-info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> key=value</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     添加额外的元信息，将存储在记录文件中。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">其他选项:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--exit-with-parent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            当启动</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> simpleperf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 的进程终止时停止记录。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--start_profiling_fd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fd_no</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    开始分析后，写入</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;STARTED&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 到</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">fd_n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">o</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">，然后关闭</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">fd_n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">o</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--stdio-controls-profiling</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    使用</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stdin/stdout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 暂停/恢复分析。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--in-app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      我们已经在应用的上下文中运行。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--tracepoint-events</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file_name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   从</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [file_name] 而不是 tracefs 中读取跟踪点事件。</span></span></code></pre></div>`,6),p=[k];function l(t,F,e,r,d,g){return i(),a("div",null,p)}const B=s(h,[["render",l]]);export{C as __pageData,B as default};
